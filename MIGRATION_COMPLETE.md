# –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –∑–∞–≤–µ—Ä—à–µ–Ω

## ‚úÖ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. –°–æ–∑–¥–∞–Ω–∞ –Ω–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

#### –ë–∞–∑–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã HTTP —Å–ª–æ—è
- ‚úÖ `app/Http/Router.php` - –†–æ—É—Ç–µ—Ä —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π middleware –∏ –≥—Ä—É–ø–ø –º–∞—Ä—à—Ä—É—Ç–æ–≤
- ‚úÖ `app/Http/Request.php` - –û–±–µ—Ä—Ç–∫–∞ –Ω–∞–¥ HTTP –∑–∞–ø—Ä–æ—Å–∞–º–∏
- ‚úÖ `app/Http/Response.php` - –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
- ‚úÖ `app/Http/Route.php` - –ö–ª–∞—Å—Å –º–∞—Ä—à—Ä—É—Ç–∞

#### Middleware
- ‚úÖ `app/Http/Middleware/AuthMiddleware.php` - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- ‚úÖ `app/Http/Middleware/GuestMiddleware.php` - –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª—è –≥–æ—Å—Ç–µ–π
- ‚úÖ `app/Http/Middleware/AdminMiddleware.php` - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- ‚úÖ `app/Http/Middleware/CsrfMiddleware.php` - –ó–∞—â–∏—Ç–∞ –æ—Ç CSRF
- ‚úÖ `app/Http/Middleware/RateLimitMiddleware.php` - Rate limiting

#### –°–µ—Ä–≤–∏—Å—ã
- ‚úÖ `app/Services/AuthService.php` - –û–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–π AuthService (–≤–º–µ—Å—Ç–æ AuthManager + 9 —Ç—Ä–µ–π—Ç–æ–≤)
- ‚úÖ `app/Services/RateLimitService.php` - –°–µ—Ä–≤–∏—Å –¥–ª—è rate limiting

#### –í–∞–ª–∏–¥–∞—Ç–æ—Ä—ã
- ‚úÖ `app/Validators/ApplicationValidator.php` - –í–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞—è–≤–æ–∫
- ‚úÖ `app/Validators/UserValidator.php` - –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

#### –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã API
- ‚úÖ `app/Controllers/Api/AuthController.php` - –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- ‚úÖ `app/Controllers/Api/UserController.php` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
- ‚úÖ `app/Controllers/Api/ApplicationController.php` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞—è–≤–∫–∞–º–∏
- ‚úÖ `app/Controllers/Api/ModpackController.php` - –ú–æ–¥–ø–∞–∫–∏
- ‚úÖ `app/Controllers/Api/ChatController.php` - –ß–∞—Ç
- ‚úÖ `app/Controllers/Api/NotificationController.php` - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- ‚úÖ `app/Controllers/Api/AdminController.php` - –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

#### –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã Web
- ‚úÖ `app/Controllers/Web/HomeController.php` - –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
- ‚úÖ `app/Controllers/Web/AuthController.php` - –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (–≤–µ–±)
- ‚úÖ `app/Controllers/Web/ProfileController.php` - –ü—Ä–æ—Ñ–∏–ª–∏
- ‚úÖ `app/Controllers/Web/ModpackController.php` - –°—Ç—Ä–∞–Ω–∏—Ü—ã –º–æ–¥–ø–∞–∫–æ–≤
- ‚úÖ `app/Controllers/Web/SettingsController.php` - –ù–∞—Å—Ç—Ä–æ–π–∫–∏
- ‚úÖ `app/Controllers/Web/ChatController.php` - –ß–∞—Ç (–≤–µ–±)
- ‚úÖ `app/Controllers/Web/AdminController.php` - –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (–≤–µ–±)

#### –ú–∞—Ä—à—Ä—É—Ç—ã
- ‚úÖ `routes/web.php` - –í–µ–±-–º–∞—Ä—à—Ä—É—Ç—ã
- ‚úÖ `routes/api.php` - API –º–∞—Ä—à—Ä—É—Ç—ã

### 2. –û–±–Ω–æ–≤–ª–µ–Ω—ã —Ñ–∞–π–ª—ã

- ‚úÖ `public/index.php` - –û–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ —Ä–æ—É—Ç–µ—Ä–∞
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ –ø–∞–ø–∫–∞ `storage/` –¥–ª—è –∫—ç—à–∞ –∏ –ª–æ–≥–æ–≤

## üîÑ –ß—Ç–æ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å

### 1. –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–æ —Å—Ç–∞—Ä—ã–º –∫–æ–¥–æ–º

–°—Ç–∞—Ä—ã–µ —Ñ–∞–π–ª—ã –º–∞—Ä—à—Ä—É—Ç–æ–≤ (`index/Routes/` –∏ `index/RoutesAPI/`) **–ù–ï –£–î–ê–õ–ï–ù–´** –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏. –û–Ω–∏ –±–æ–ª—å—à–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è, –Ω–æ –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏.

### 2. –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

–í `public/index.php` –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≥–ª–æ–±–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `$user` –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å–æ —Å—Ç–∞—Ä—ã–º–∏ —à–∞–±–ª–æ–Ω–∞–º–∏. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —à–∞–±–ª–æ–Ω—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

### 3. –ò–º–ø–æ—Ä—Ç—ã –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞—Ö

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ –∏–º–ø–æ—Ä—Ç—ã –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ:
- `App\Service\ImageService` ‚Üí –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å `App\Service\ImageService` (–Ω–µ `Services`)
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –∫–ª–∞—Å—Å—ã —Å—É—â–µ—Å—Ç–≤—É—é—Ç

### 4. Middleware –≤ –º–∞—Ä—à—Ä—É—Ç–∞—Ö

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ middleware –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è:
- `auth` - —Ç—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- `guest` - —Ç—Ä–µ–±—É–µ—Ç, —á—Ç–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±—ã–ª –≥–æ—Å—Ç–µ–º
- `admin` - —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- `csrf` - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç CSRF —Ç–æ–∫–µ–Ω
- `rate_limit:5,60` - –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ (5 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ 60 —Å–µ–∫—É–Ω–¥)

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### 1. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü—ã
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –∏ CSRF –∑–∞—â–∏—Ç—É
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å rate limiting

### 2. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- [ ] –û–±—ä–µ–¥–∏–Ω–∏—Ç—å —Ç—Ä–µ–π—Ç—ã —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ –≤ –∫–ª–∞—Å—Å—ã
- [ ] –î–æ–±–∞–≤–∏—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å SQL –∑–∞–ø—Ä–æ—Å—ã

### 3. –û—á–∏—Å—Ç–∫–∞ (–ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
- [ ] –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ —Ñ–∞–π–ª—ã –º–∞—Ä—à—Ä—É—Ç–æ–≤ (`index/Routes/` –∏ `index/RoutesAPI/`)
- [ ] –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ —Ç—Ä–µ–π—Ç—ã (`app/Auth/AuthManager/`)
- [ ] –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–π `app/Auth/AuthManager.php`

## ‚ö†Ô∏è –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **–ü–∞–ø–∫–∞ storage** - —Å–æ–∑–¥–∞–Ω–∞ –≤—Ä—É—á–Ω—É—é –∏–∑-–∑–∞ –ø—Ä–æ–±–ª–µ–º —Å –∫–∏—Ä–∏–ª–ª–∏—Ü–µ–π –≤ –ø—É—Ç–∏. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–∞–ø–∫–∏ `storage/cache` –∏ `storage/logs` —Å—É—â–µ—Å—Ç–≤—É—é—Ç.

2. **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - —Å—Ç–∞—Ä—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ `json()`, `redirect()` –∏–∑ `bootstrap.php` –≤—Å–µ –µ—â–µ —Ä–∞–±–æ—Ç–∞—é—Ç, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `Response::json()` –∏ `Response::redirect()`.

3. **–ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ** - `$user` –∏ `$unreadNotifications` –≤—Å–µ –µ—â–µ –¥–æ—Å—Ç—É–ø–Ω—ã –≥–ª–æ–±–∞–ª—å–Ω–æ –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å–æ —Å—Ç–∞—Ä—ã–º–∏ —à–∞–±–ª–æ–Ω–∞–º–∏.

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

1. ‚úÖ **–ß–∏—Ç–∞–µ–º–æ—Å—Ç—å** - –∫–æ–¥ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω –ø–æ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞–º
2. ‚úÖ **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** - –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã
3. ‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –∏ –∑–∞—â–∏—Ç–∞
4. ‚úÖ **–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ** - –º–µ–Ω—å—à–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞
5. ‚úÖ **–¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å** - –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã –ª–µ–≥–∫–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- `ANALYSIS.md` - –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º
- `NEW_STRUCTURE_PROPOSAL.md` - –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- `REFACTORING_SUMMARY.md` - –ö—Ä–∞—Ç–∫–∞—è —Å–≤–æ–¥–∫–∞
